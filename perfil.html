<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bloom Beauty</title>
    <link rel="icon" href="recursos/Logo.ico" type="image/x-icon">
    <link rel="stylesheet" href="estiloPerfil.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Navbar -->
    <nav>
        <div class="menu-section">
            <ul class="nav-links">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="productos.html">Productos</a></li>
            </ul>
        </div>
        <div class="logo-container">
            <h1>Bloom Beauty</h1>
        </div>
        <div class="icons">
            <div class="search-container">
                <input type="text" id="search-bar" class="search-bar" placeholder="Buscar...">
                <img src="Recursos/BtnSearch.png" alt="Buscar" class="icon" id="search-icon">
            </div>
            <img src="Recursos/BtnCarrito.png" alt="Carrito" class="icon" id="btn-carrito">
            <img src="Recursos/BtnPerfil.png" alt="Perfil" class="icon btn-user" id="btn-perfil">
        </div>
    </nav>

    <!-- Contenido del Perfil -->
      <div class="profile-container">
        <div class="profile-content">
            <div class="profile-sidebar">
                <ul class="profile-menu">
                    <li><a href="#" class="tab-link" data-tab="personal"><i class="fas fa-user"></i> Información Personal</a></li>
                    <li><a href="#" class="tab-link active" data-tab="orders"><i class="fas fa-shopping-bag"></i> Mis Pedidos</a></li>
                    <li><a href="#" class="tab-link" data-tab="addresses"><i class="fas fa-map-marker-alt"></i> Direcciones</a></li>
                    <li><a href="#" class="tab-link" data-tab="security"><i class="fas fa-lock"></i> Seguridad</a></li>
                    <li><a href="#" id="btn-logout"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a></li>
                </ul>
            </div>

            <div class="profile-main">

                <div class="profile-section" id="personal">
                      <h2><i class="fas fa-user"></i> Información Personal</h2>
                         <div id="info-personal">
                         <!-- Aquí se insertarán los datos del usuario -->
                         </div>
                </div>

                <!-- Sección de Pedidos (activa por defecto) -->
                <div class="profile-section active" id="orders">
                    <h2><i class="fas fa-shopping-bag"></i> Mis Pedidos</h2>
                    <table class="orders-table">
                        <thead>
                            <tr>
                                <th>N° Pedido</th>
                                <th>Fecha</th>
                                <th>Productos</th>
                                <th>Total</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>#BB-2023-001</td>
                                <td>15/01/2023</td>
                                <td>Bloom Punch, Silk Glow</td>
                                <td>$1,398.00 MXN</td>
                                <td>Entregado</td>
                            </tr>
                            <tr>
                                <td>#BB-2023-002</td>
                                <td>28/02/2023</td>
                                <td>HydraBloom</td>
                                <td>$499.00 MXN</td>
                                <td>En camino</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Sección de Direcciones -->
                <div class="profile-section" id="addresses">
                    <h2><i class="fas fa-map-marker-alt"></i> Mis Direcciones</h2>
                    <div class="address-card">
                        <h3>Dirección Principal</h3>
                        <p>María González</p>
                        <p>Calle Flores #123, Colonia Centro</p>
                        <p>Morelia, Michoacán, 58000</p>
                        <p>Teléfono: +52 612 345 6789</p>
                        <div class="address-actions">
                            <button>
                                <span class="img-container">
                                    <img src="Recursos/editar.png" alt="Editar">
                                </span>
                                <span>Editar</span>
                            </button>
                            <button>
                                <span class="img-container">
                                    <img src="Recursos/eliminar.png" alt="Eliminar">
                                </span>
                                <span>Eliminar</span>
                            </button>
                        </div>
                    </div>
                    <button class="save-btn">+ Añadir nueva dirección</button>
                </div>

               <!-- Sección de Seguridad -->
<div class="profile-section" id="security">
    <h2><i class="fas fa-lock"></i> Seguridad</h2>
    <div class="security-item">
        <div class="security-info">
            <h3>Contraseña</h3>
            <p>Última actualización hace 3 meses</p>
        </div>
        <div class="security-action">
            <button onclick="mostrarFormularioContrasena()">Cambiar contraseña</button>
        </div>
    </div>

    <!-- Formulario para cambiar contraseña -->
    <div id="form-cambiar-contrasena" style="display: none; margin-top: 20px;">
        <input type="password" id="actualContrasena" placeholder="Contraseña actual" required>
        <input type="password" id="nuevaContrasena" placeholder="Nueva contraseña" required>
        <button onclick="cambiarContrasena()">Guardar nueva contraseña</button>
        <p id="mensajeCambio" style="color: red;"></p>
    </div>
</div>

            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-line"></div> 
        <h2>Bloom Beauty</h2>
        <p>
            Belleza auténtica, cuidado natural. Consciéntete con fórmulas sofisticadas que nutren tu piel y realzan tu esencia. Porque tu bienestar es nuestra inspiración.
        </p>
        <div class="footer-line"></div> 
        <div class="footer-links">
            <a href="#">Información de Contacto</a>
            <a href="#">Términos y Condiciones</a>
            <a href="#">Política de Privacidad</a>
            <a href="#">Política de Envío</a>
            <a href="#">Política de Devolución</a>
        </div>
        <div class="footer-social">
            <a href="#"><img src="Recursos/LogoInstagram.png" alt="Instagram" class="icon"></a>
            <a href="#"><img src="Recursos/LogoFacebook.png" alt="Facebook" class="icon"></a>
        </div>
        <div class="footer-subscribe">
            <input type="email" placeholder="Correo Electrónico">
            <button type="submit">→</button>
        </div>
    </footer>

    <script>
        // Funcionalidad de las pestañas
        document.querySelectorAll('.tab-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remover clase active de todos los links y secciones
                document.querySelectorAll('.tab-link').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.profile-section').forEach(el => el.classList.remove('active'));
                
                // Añadir clase active al link clickeado
                this.classList.add('active');
                
                // Mostrar la sección correspondiente
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });
    </script>

    <script>

document.addEventListener('DOMContentLoaded', () => {
    const btnLogout = document.getElementById('btn-logout');
    if (btnLogout) {
        btnLogout.addEventListener('click', (e) => {
            e.preventDefault(); // Prevenir comportamiento por defecto
            window.location.href = 'logout.php'; // Redirige a logout.php
        });
    }
});
</script>
<script>
    // Cargar datos del usuario desde localStorage al hacer clic en "Información Personal"
    document.querySelector('[data-tab="personal"]').addEventListener('click', function () {
        const userData = JSON.parse(localStorage.getItem('usuario'));
        const infoDiv = document.getElementById('info-personal');

        if (userData) {
            infoDiv.innerHTML = `
                <p><strong>Nombre:</strong> ${userData.nombre}</p>
                <p><strong>Correo:</strong> ${userData.correo}</p>
            `;
        } else {
            infoDiv.innerHTML = `<p>No hay información del usuario disponible.</p>`;
        }
    });
</script>


    <script>
        function mostrarFormularioContrasena() {
    document.getElementById('form-cambiar-contrasena').style.display = 'block';
}

    async function cambiarContrasena() {

    const actual = document.getElementById('actualContrasena').value;
    const nueva = document.getElementById('nuevaContrasena').value;
    const mensaje = document.getElementById('mensajeCambio');

    const usuario = JSON.parse(localStorage.getItem('usuario'));
    if (!usuario) {
        mensaje.textContent = 'No se encontró sesión activa.';
        return;
    }

    try {
        const response = await fetch('http://localhost/Bloom-Beauty/cambiar_contrasena.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                correo: usuario.correo,
                actual: actual,
                nueva: nueva
            })
        });

        const data = await response.json();
        mensaje.style.color = data.success ? 'green' : 'red';
        mensaje.textContent = data.message;

        if (data.success) {
            document.getElementById('actualContrasena').value = '';
            document.getElementById('nuevaContrasena').value = '';
        }
    } catch (error) {
        mensaje.textContent = 'Error al conectar con el servidor.';
    }
}
</script>

</body>
</html>